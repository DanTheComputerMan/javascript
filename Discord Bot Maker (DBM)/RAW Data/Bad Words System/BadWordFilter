{
  "name": "BadWordsFilter",
  "permissions": "NONE",
  "restriction": "1",
  "_id": "AjZlg",
  "actions": [
    {
      "behavior": "0",
      "interpretation": "1",
      "code": "// Javascript code here. Do NOT edit this or you WILL break it. \nconst WrexMODS = this.getWrexMods();\nconst db = WrexMODS.require('quick.db');\n\nconst systemenabledcheck = db.get(`servers.${server.id}.badwordsystem.status`) || false;\n\nif (systemenabledcheck) {\n\tconst messagetext = msg.content;\n\tconst themessage = msg;\n\tconst theUSER = msg.member.user.id;\n\tvar wordlist = db.get(`servers.${server.id}.badwordsystem.badwordlist`) || [`anal`, `anus`, `arse`, `ass`, `ballsack`, `balls`, `bastard`, `bitch`, `blowjob`, `blow job`, `boner`, `boob`, `clitoris`, `cock`, `coon`, `cunt`, `damn`, `dick`, `dildo`, `dyke`, `fag`, `fellate`, `fellatio`, `fuck`, `goddamn`, `god damn`, `hell`, `homo`, `jizz`, `labia`, `nigga`, `nigger`, `penis`, `pube`, `pussy`, `queer`, `scrotum`, `sex`, `shit`, `slut`, `smegma`, `tit`, `twat`, `vagina`, `wank`, `whore`];\n\tconst logchannel = bot.channels.get(String(db.get(`servers.${server.id}.badwordsystem.logchannelID`))) || false;\n\n\t\n/*\n\tfunction ConvArrToObj(array) { // Converts default bad word list to an object format.\n\t\tlet a = array.map(bword => (typeof(bword) != 'object') ? Object.assign({ word: String(bword), action: 'delete' }) : bword); // sets entries that are not in array format to themselves (i.e. ones that have already been converted to object format.)\n\t\tfor (var i in a) { // Converts {} empty objects to < empty item > so that boolean check below can work.\n\t\t\tif (!a[i] || typeof a[i] !== \"object\") {\n\t\t\t\tcontinue // If null or not an object, skip to the next iteration\n\t\t\t}\n\t\t\t\n\t\t\t// The property is an object\n\t\t\tif (Object.keys(a[i]).length === 0) {\n\t\t\t\tdelete a[i]; // The object had no properties, so delete that property\n\t\t\t}\n\t\t}\n\t\treturn a.filter(Boolean); // Removes {} empty objects.\n\t}\n\t// Adds new words user wants to the bad words array if they're not there already.\n\tObject.keys(new_words).forEach(key => {\n\t\tbad.push(ConvArrToObj(new_words[key]));\n\t});\n\t\n\t\n\tbad = ConvArrToObj(bad); // bad variable now holds sanitized bad words list.\n\t// Removes exact duplicate entries.\n\tbad = Array.from(new Set(bad.map(JSON.stringify))).map(JSON.parse);\n\t*/\n\t\n\tvar inMessage = false;\n\t\n\tconst inmes = (props, object) => props.reduce((exists, x) => (exists && exists[x]) ? exists[x] : null, object);\n\n\tconst stepnum = Object.keys(wordlist).length;\n\tvar actionstep = \"\"; var badword = \"\"; \n\tfor (step = stepnum; step > 0; step--) { // inclusive step. Also, for-loop down to 0 is reportedly faster.\n\t\tif (messagetext.includes(inmes([step, 'word'], wordlist))) {\n\t\t\tinMessage = true;\n\t\t\tbadword = inmes([step, 'word'], wordlist);\n\t\t\tactionstep = inmes([step, 'action'], wordlist) || 'delete'; // Which action to take.\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tvar channel = msg.channel.name;\n\tvar logmsg = \"\"; // Stores msg text to send to log channel if available.\n\t\n\tif (inMessage) {\n\t\tswitch (actionstep) {\n\t\t\tcase \"delete\":\n\t\t\t\ttry { \n\t\t\t\t\tthemessage.delete();\n\t\t\t\t\tlogmsg = logmsg+`Deleted message containing **\\`${(String(badword).length > 1900) ? String(badword) + '…' : String(badword)}\\`** by ${member || `an unknown user (${msg.author.id})`}.\\n`;\n\t\t\t\t} catch { \n\t\t\t\t\tlogmsg = logmsg+`I don't have delete messages permission in ${channel.name}\\n`;\n\t\t\t\t}\n\t\t\t\tif (logchannel) { logchannel.send(logmsg); }\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase \"kick\":\n\t\t\t\ttry { themessage.delete(); } catch { logmsg = logmsg+`I don't have delete messages permission in ${channel.name}`; }\n\t\t\t\tif (server.members.get(member.id).kickable) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmsg.author.send(`You have been kicked from ${(String(server.name || \"an unknown server\").length > 100) ? String(server.name || \"an unknown server\").substring(0,100) + '…' : String(server.name || \"an unknown server\")} for typing **\\`${(String(badword).length > 1800) ? String(badword).substring(0, 1800) : String(badword)}\\`** in your message.\\n`);\n\t\t\t\t\t} catch {\n\t\t\t\t\t\tlogmsg = logmsg+`Couldn't send Kick DM message to ${member || `an unknown user (${msg.author.id})`}.\\n`;\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tserver.members.get(theUSER).kick()/*.catch(\n\t\t\t\t\t\t\tif (logchannel) { logchannel.send(`Couldn't kick ${member.displayName || \"Unknown user\"} from this server. Make sure I'm higher than them!`); }*/\n\t\t\t\t\t} catch {\n\t\t\t\t\t\tlogmsg = logmsg+`Couldn't kick ${member || `an unknown user (${msg.author.id})`} from this server. Make sure I'm higher than them!\\n`;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlogmsg = logmsg+`Deleted message containing **\\`${(String(badword).length > 1800) ? String(badword).substring(0, 1800) : String(badword)}\\`**\\n\\nAlso, I can't kick ${member || `an unknown user (${msg.author.id})`}. Make sure I'm higher than them!\\n`;\n\t\t\t\t}\n\t\t\t\tif (logchannel) { logchannel.send(logmsg); }\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase \"ban\":\n\t\t\t\ttry { themessage.delete(); } catch { logmsg = logmsg+`I don't have delete messages permission in ${channel.name}\\n`; }\n\t\t\t\tif (server.members.get(member.id).bannable) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmsg.author.send(`You have been banned from ${(String(server.name || \"an unknown server\").length > 100) ? String(server.name || \"an unknown server\").substring(0,100) + '...' : String(server.name || \"an unknown server\")} for typing **\\`${(String(badword).length > 1800) ? String(badword).substring(0, 1800) : String(badword)}\\`** in your message.\\n`);\n\t\t\t\t\t} catch {\n\t\t\t\t\t\tlogmsg = logmsg+`Couldn't send Ban DM message to ${member || `an unknown user (${msg.author.id})`}.\\n`;\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmsg.guild.ban(theUSER);\n\t\t\t\t\t} catch {\n\t\t\t\t\t\tilogmsg = logmsg+`Couldn't ban ${member || `an unknown user (${msg.author.id})`} from this server.\\n`;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlogmsg = logmsg+`Deleted message containing **\\`${(String(badword).length > 1800) ? String(badword).substring(0, 1800) : String(badword)}\\`**\\n\\nAlso, I can't ban ${member || `an unknown user (${msg.author.id})`}. Make sure I'm higher than them!\\n`;\n\t\t\t\t}\n\t\t\t\tif (logchannel) { logchannel.send(logmsg); }\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t// case \"call\":\n\t\t\t\t// themessage.delete();\n\t\t\t\t\n\t\t\tdefault:\n\t\t\t\tmsg.delete(msg);\n\t\t}\n\t}\n}",
      "storage": "0",
      "varName": "",
      "name": "Run Script"
    }
  ],
  "comType": "3"
}
